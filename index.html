<!DOCTYPE html>
<html>
<head>
    <title>JSON API</title>
    <style>
        .filter-section { margin: 20px 0; padding: 15px; background: #f5f5f5; }
        input, button { padding: 8px; margin: 5px; }
        .result { margin: 10px 0; padding: 10px; border-left: 3px solid #007cba; }
    </style>
</head>
<body>
    <h1>JSON API via GitHub</h1>
    
    <!-- Filter Section -->
    <div class="filter-section">
        <h2>Advanced Filter</h2>
        <input type="number" id="filterId" placeholder="ID">
        <input type="text" id="filterTitle" placeholder="Title contains...">
        <input type="text" id="filterContent" placeholder="Content contains...">
        <select id="codeType">
            <option value="civil_and_commercial_code">Civil and Commercial Code</option>
            <option value="criminal_code">Criminal Code</option>
            <option value="civil_procedure_code">Civil Procedure Code</option>
        </select>
        <button onclick="advancedFilter()">Advanced Filter</button>
    </div>

    <!-- Results Section -->
    <div id="results"></div>

    <!-- Direct Links -->
    <h2>Direct Access:</h2>
    <ul>
        <li><a href="api/civil_and_commercial_code.json">civil_and_commercial_code.json</a></li>
        <li><a href="api/criminal_code.json">criminal_code.json</a></li>
        <li><a href="api/civil_procedure_code.json">civil_procedure_code.json</a></li>
    </ul>

    <script>
        async function filterById() {
            const id = document.getElementById('filterId').value;
            const codeType = document.getElementById('codeType').value;
            
            if (!id) {
                alert('Please enter an ID');
                return;
            }

            try {
                const response = await fetch(`api/${codeType}.json`);
                const data = await response.json();
                
                // Filter by ID
                const items = data[codeType];
                const filteredItem = items.find(item => item.id == id); // Use == for string/number comparison
                
                displayResults(filteredItem, codeType);
            } catch (error) {
                document.getElementById('results').innerHTML = 
                    `<div class="result error">Error loading data: ${error.message}</div>`;
            }
        }

        async function getAllData() {
            const codeType = document.getElementById('codeType').value;
            
            try {
                const response = await fetch(`api/${codeType}.json`);
                const data = await response.json();
                displayResults(data[codeType], codeType, true);
            } catch (error) {
                document.getElementById('results').innerHTML = 
                    `<div class="result error">Error loading data: ${error.message}</div>`;
            }
        }

        function displayResults(data, codeType, showAll = false) {
            const resultsDiv = document.getElementById('results');
            
            if (showAll) {
                resultsDiv.innerHTML = `<h3>All ${codeType.replace(/_/g, ' ')} (${data.length} items):</h3>`;
                data.forEach(item => {
                    resultsDiv.innerHTML += `
                        <div class="result">
                            <strong>ID ${item.id}: ${item.title}</strong>
                            <p>${item.content}</p>
                        </div>
                    `;
                });
            } else {
                if (data) {
                    resultsDiv.innerHTML = `
                        <h3>Found in ${codeType.replace(/_/g, ' ')}:</h3>
                        <div class="result">
                            <strong>ID ${data.id}: ${data.title}</strong>
                            <p>${data.content}</p>
                        </div>
                    `;
                } else {
                    resultsDiv.innerHTML = `<div class="result">No item found with ID ${document.getElementById('filterId').value}</div>`;
                }
            }
        }
        async function advancedFilter() {
    const codeType = document.getElementById('codeType').value;
    const filterId = document.getElementById('filterId').value;
    const filterTitle = document.getElementById('filterTitle').value.toLowerCase();
    const filterContent = document.getElementById('filterContent').value.toLowerCase();
    
    try {
        const response = await fetch(`api/${codeType}.json`);
        const data = await response.json();
        const items = data[codeType];
        
        const filteredItems = items.filter(item => {
            return (!filterId || item.id == filterId) &&
                   (!filterTitle || item.title.toLowerCase().includes(filterTitle)) &&
                   (!filterContent || item.content.toLowerCase().includes(filterContent));
        });
        
        displayAdvancedResults(filteredItems, codeType);
    } catch (error) {
        document.getElementById('results').innerHTML = 
            `<div class="result error">Error: ${error.message}</div>`;
    }
}

function displayAdvancedResults(items, codeType) {
    const resultsDiv = document.getElementById('results');
    
    if (items.length > 0) {
        resultsDiv.innerHTML = `<h3>Found ${items.length} items in ${codeType.replace(/_/g, ' ')}:</h3>`;
        items.forEach(item => {
            resultsDiv.innerHTML += `
                <div class="result">
                    <strong>ID ${item.id}: ${item.title}</strong>
                    <p>${item.content}</p>
                </div>
            `;
        });
    } else {
        resultsDiv.innerHTML = `<div class="result">No items found matching your criteria</div>`;
    }
}
    </script>
</body>
</html>
